local GetUi = ui.get
local SetUi = ui.set
local NewCheckbox = ui.new_checkbox
local NewCombo = ui.new_combobox
local NewSlider = ui.new_slider
local SetVisible = ui.set_visible
local SetCallback = ui.set_callback

local GetLocalPlayer = entity.get_local_player
local GetAll = entity.get_all

local Log = client.log

local AddEvent = client.set_event_callback

local misc, misc2 = "misc", "miscellaneous"

local coin_list = {
    [0] = "5 Year Veteran Coin",
    [1] = "Champion at DreamHack 2013",
    [2] = "Finalist at DreamHack 2013",
    [3] = "Semifinalist at DreamHack 2013",
    [4] = "Quarterfinalist at DreamHack 2013",
    [5] = "Champion at EMS One Katowice 2014",
    [6] = "Finalist at EMS One Katowice 2014",
    [7] = "Semifinalist at EMS One Katowice 2014",
    [8] = "Quarterfinalist at EMS One Katowice 2014",
    [9] = "Champion at ESL One Cologne 2014",
    [10] = "Finalist at ESL One Cologne 2014",
    [11] = "Semifinalist at ESL One Cologne 2014",
    [12] = "Quarterfinalist at ESL One Cologne 2014",
    [13] = "Bronze Cologne 2014 Pick'Em Trophy",
    [14] = "Silver Cologne 2014 Pick'Em Trophy",
    [15] = "Gold Cologne 2014 Pick'Em Trophy",
    [16] = "Champion at DreamHack Winter 2014",
    [17] = "Finalist at DreamHack Winter 2014",
    [18] = "Semifinalist at DreamHack Winter 2014",
    [19] = "Quarterfinalist at DreamHack Winter 2014",
    [20] = "Bronze DreamHack 2014 Pick'Em Trophy",
    [21] = "Silver DreamHack 2014 Pick'Em Trophy",
    [22] = "Gold DreamHack 2014 Pick'Em Trophy",
    [23] = "Champion at ESL One Katowice 2015",
    [24] = "Finalist at ESL One Katowice 2015",
    [25] = "Semifinalist at ESL One Katowice 2015",
    [26] = "Quarterfinalist at ESL One Katowice 2015",
    [27] = "Bronze Katowice 2015 Pick'Em Trophy",
    [28] = "Silver Katowice 2015 Pick'Em Trophy",
    [29] = "Gold Katowice 2015 Pick'Em Trophy",
    [30] = "Champion at ESL One Cologne 2015",
    [31] = "Finalist at ESL One Cologne 2015",
    [32] = "Semifinalist at ESL One Cologne 2015",
    [33] = "Quarterfinalist at ESL One Cologne 2015",
    [34] = "Bronze Cologne 2015 Pick'Em Trophy",
    [35] = "Silver Cologne 2015 Pick'Em Trophy",
    [36] = "Gold Cologne 2015 Pick'Em Trophy",
    [37] = "Bronze Cluj-Napoca 2015 Pick'Em Trophy",
    [38] = "Silver Cluj-Napoca 2015 Pick'Em Trophy",
    [39] = "Gold Cluj-Napoca 2015 Pick'Em Trophy",
    [40] = "Bronze Cluj-Napoca 2015 Fantasy Trophy",
    [41] = "Silver Cluj-Napoca 2015 Fantasy Trophy",
    [42] = "Gold Cluj-Napoca 2015 Fantasy Trophy",
    [43] = "Champion at DreamHack Cluj-Napoca 2015",
    [44] = "Finalist at DreamHack Cluj-Napoca 2015",
    [45] = "Semifinalist at DreamHack Cluj-Napoca 2015",
    [46] = "Quarterfinalist at DreamHack Cluj-Napoca 2015",
    [47] = "Bronze Columbus 2016 Pick'Em Trophy",
    [48] = "Silver Columbus 2016 Pick'Em Trophy",
    [49] = "Gold Columbus 2016 Pick'Em Trophy",
    [50] = "Bronze Columbus 2016 Fantasy Trophy",
    [51] = "Silver Columbus 2016 Fantasy Trophy",
    [52] = "Gold Columbus 2016 Fantasy Trophy",
    [53] = "Champion at MLG Columbus 2016",
    [54] = "Finalist at MLG Columbus 2016",
    [55] = "Semifinalist at MLG Columbus 2016",
    [56] = "Quarterfinalist at MLG Columbus 2016",
    [57] = "Champion at ESL One Cologne 2016",
    [58] = "Finalist at ESL One Cologne 2016",
    [59] = "Semifinalist at ESL One Cologne 2016",
    [60] = "Quarterfinalist at ESL One Cologne 2016",
    [61] = "Bronze Cologne 2016 Pick'Em Trophy",
    [62] = "Silver Cologne 2016 Pick'Em Trophy",
    [63] = "Gold Cologne 2016 Pick'Em Trophy",
    [64] = "Bronze Cologne 2016 Fantasy Trophy",
    [65] = "Silver Cologne 2016 Fantasy Trophy",
    [66] = "Gold Cologne 2016 Fantasy Trophy",
    [67] = "Champion at ELEAGUE Atlanta 2017",
    [68] = "Finalist at ELEAGUE Atlanta 2017",
    [69] = "Semifinalist at ELEAGUE Atlanta 2017",
    [70] = "Quarterfinalist at ELEAGUE Atlanta 2017",
    [71] = "Bronze Atlanta 2017 Pick'Em Trophy",
    [72] = "Silver Atlanta 2017 Pick'Em Trophy",
    [73] = "Gold Atlanta 2017 Pick'Em Trophy",
    [74] = "Champion at PGL Krakow 2017",
    [75] = "Finalist at PGL Krakow 2017",
    [76] = "Semifinalist at PGL Krakow 2017",
    [77] = "Quarterfinalist at PGL Krakow 2017",
    [78] = "Bronze Krakow 2017 Pick'Em Trophy",
    [79] = "Silver Krakow 2017 Pick'Em Trophy",
    [80] = "Gold Krakow 2017 Pick'Em Trophy",
    [81] = "Champion at ELEAGUE Boston 2018",
    [82] = "Finalist at ELEAGUE Boston 2018",
    [83] = "Semifinalist at ELEAGUE Boston 2018",
    [84] = "Quarterfinalist at ELEAGUE Boston 2018",
    [85] = "Bronze Boston 2018 Pick'Em Trophy",
    [86] = "Silver Boston 2018 Pick'Em Trophy",
    [87] = "Gold Boston 2018 Pick'Em Trophy",
    [88] = "Champion at FACEIT London 2018",
    [89] = "Finalist at FACEIT London 2018",
    [90] = "Semifinalist at FACEIT London 2018",
    [91] = "Quarterfinalist at FACEIT London 2018",
    [92] = "Bronze London 2018 Pick'Em Trophy",
    [93] = "Silver London 2018 Pick'Em Trophy",
    [94] = "Gold London 2018 Pick'Em Trophy",
    [95] = "Operation Payback Pass",
    [96] = "Operation Payback Challenge Coin",
    [97] = "Silver Operation Payback Coin",
    [98] = "Gold Operation Payback Coin",
    [99] = "Museum Map Coin",
    [100] = "Downtown Map Coin",
    [101] = "Thunder Map Coin",
    [102] = "Favela Map Coin",
    [103] = "Motel Map Coin",
    [104] = "Seaside Map Coin",
    [105] = "Library Map Coin",
    [106] = "Operation Bravo Pass",
    [107] = "Operation Bravo Challenge Coin",
    [108] = "Silver Operation Bravo Coin",
    [109] = "Gold Operation Bravo Coin",
    [110] = "Agency Map Coin",
    [111] = "Ali Map Coin",
    [112] = "Cache Map Coin",
    [113] = "Chinatown Map Coin",
    [114] = "Gwalior Map Coin",
    [115] = "Ruins Map Coin",
    [116] = "Siege Map Coin",
    [117] = "Operation Phoenix Pass",
    [118] = "Operation Phoenix Challenge Coin",
    [119] = "Silver Operation Phoenix Coin",
    [120] = "Gold Operation Phoenix Coin",
    [121] = "Operation Breakout All Access Pass",
    [122] = "Operation Breakout Challenge Coin",
    [123] = "Silver Operation Breakout Coin",
    [124] = "Gold Operation Breakout Coin",
    [125] = "Operation Vanguard Challenge Coin",
    [126] = "Silver Operation Vanguard Coin",
    [127] = "Gold Operation Vanguard Coin  ",
    [128] = "Operation Bloodhound Challenge Coin",
    [129] = "Silver Operation Bloodhound Coin",
    [130] = "Gold Operation Bloodhound Coin",
    [131] = "2015 Service Medal",
    [132] = "2015 Service Medal",
    [133] = "Operation Wildfire Challenge Coin",
    [134] = "Silver Operation Wildfire Coin",
    [135] = "Gold Operation Wildfire Coin",
    [136] = "2016 Service Medal",
    [137] = "2016 Service Medal",
    [138] = "2016 Service Medal",
    [139] = "2016 Service Medal",
    [140] = "2016 Service Medal",
    [141] = "2016 Service Medal",
    [142] = "Counter-Strike: Global Offensive Game License",
    [143] = "2017 Service Medal",
    [144] = "2017 Service Medal",
    [145] = "2017 Service Medal",
    [146] = "2017 Service Medal",
    [147] = "2017 Service Medal",
    [148] = "2017 Service Medal",
    [149] = "2017 Service Medal",
    [150] = "2018 Service Medal",
    [151] = "2018 Service Medal",
    [152] = "2018 Service Medal",
    [153] = "2018 Service Medal",
    [154] = "2018 Service Medal",
    [155] = "2018 Service Medal  ",
    [156] = "Operation Hydra Challenge Coin",
    [157] = "Silver Operation Hydra Coin",
    [158] = "Gold Operation Hydra Coin",
    [159] = "Diamond Operation Hydra Coin",
    [160] = "Dust II Pin",
    [161] = "Guardian Elite Pin",
    [162] = "Mirage Pin",
    [163] = "Inferno Pin",
    [164] = "Italy Pin",
    [165] = "Victory Pin",
    [166] = "Militia Pin",
    [167] = "Nuke Pin",
    [168] = "Train Pin",
    [169] = "Guardian Pin",
    [170] = "Tactics Pin",
    [171] = "Guardian 2 Pin",
    [172] = "Bravo Pin",
    [173] = "Baggage Pin",
    [174] = "Phoenix Pin",
    [175] = "Office Pin",
    [176] = "Cobblestone Pin",
    [177] = "Overpass Pin",
    [178] = "Bloodhound Pin",
    [179] = "Cache Pin",
    [180] = "Valeria Phoenix Pin",
    [181] = "Chroma Pin",
    [182] = "Guardian 3 Pin",
    [183] = "Canals Pin",
    [184] = "Welcome to the Clutch Pin",
    [185] = "Death Sentence Pin",
    [186] = "Inferno 2 Pin",
    [187] = "Wildfire Pin",
    [188] = "Easy Peasy Pin",
    [189] = "Aces High Pin",
    [190] = "Hydra Pin",
    [191] = "Howl Pin",
    [192] = "Brigadier General Pin",
    [193] = "Dust II Pin",
    [194] = "Guardian Elite Pin",
    [195] = "Mirage Pin",
    [196] = "Inferno Pin",
    [197] = "Italy Pin",
    [198] = "Victory Pin",
    [199] = "Militia Pin",
    [200] = "Nuke Pin",
    [201] = "Train Pin",
    [202] = "Guardian Pin",
    [203] = "Tactics Pin",
    [204] = "Guardian 2 Pin",
    [205] = "Bravo Pin",
    [206] = "Baggage Pin",
    [207] = "Phoenix Pin",
    [208] = "Office Pin",
    [209] = "Cobblestone Pin",
    [210] = "Overpass Pin",
    [211] = "Bloodhound Pin",
    [212] = "Cache Pin",
    [213] = "Valeria Phoenix Pin",
    [214] = "Chroma Pin",
    [215] = "Guardian 3 Pin",
    [216] = "Canals Pin",
    [217] = "Welcome to the Clutch Pin",
    [218] = "Death Sentence Pin",
    [219] = "Inferno 2 Pin",
    [220] = "Wildfire Pin",
    [221] = "Easy Peasy Pin",
    [222] = "Aces High Pin",
    [223] = "Hydra Pin",
    [224] = "Howl Pin",
    [225] = "Brigadier General Pin",
}

local coin_ids = {
    [0] = 874,
    [1] = 875,
    [2] = 876,
    [3] = 877,
    [4] = 878,
    [5] = 879,
    [6] = 880,
    [7] = 881,
    [8] = 882,
    [9] = 883,
    [10] = 884,
    [11] = 885,
    [12] = 886,
    [13] = 887,
    [14] = 888,
    [15] = 889,
    [16] = 890,
    [17] = 891,
    [18] = 892,
    [19] = 893,
    [20] = 894,
    [21] = 895,
    [22] = 896,
    [23] = 897,
    [24] = 898,
    [25] = 899,
    [26] = 900,
    [27] = 901,
    [28] = 902,
    [29] = 903,
    [30] = 904,
    [31] = 905,
    [32] = 906,
    [33] = 907,
    [34] = 908,
    [35] = 909,
    [36] = 910,
    [37] = 911,
    [38] = 912,
    [39] = 913,
    [40] = 914,
    [41] = 915,
    [42] = 916,
    [43] = 917,
    [44] = 918,
    [45] = 919,
    [46] = 920,
    [47] = 921,
    [48] = 922,
    [49] = 923,
    [50] = 924,
    [51] = 925,
    [52] = 926,
    [53] = 927,
    [54] = 928,
    [55] = 929,
    [56] = 930,
    [57] = 931,
    [58] = 932,
    [59] = 933,
    [60] = 934,
    [61] = 935,
    [62] = 936,
    [63] = 937,
    [64] = 938,
    [65] = 939,
    [66] = 940,
    [67] = 941,
    [68] = 942,
    [69] = 943,
    [70] = 944,
    [71] = 945,
    [72] = 946,
    [73] = 947,
    [74] = 948,
    [75] = 949,
    [76] = 950,
    [77] = 951,
    [78] = 952,
    [79] = 953,
    [80] = 954,
    [81] = 955,
    [82] = 956,
    [83] = 957,
    [84] = 958,
    [85] = 959,
    [86] = 960,
    [87] = 961,
    [88] = 962,
    [89] = 963,
    [90] = 964,
    [91] = 965,
    [92] = 966,
    [93] = 967,
    [94] = 968,
    [95] = 1000,
    [96] = 1001,
    [97] = 1002,
    [98] = 1003,
    [99] = 1004,
    [100] = 1005,
    [101] = 1006,
    [102] = 1007,
    [103] = 1008,
    [104] = 1009,
    [105] = 1010,
    [106] = 1012,
    [107] = 1013,
    [108] = 1014,
    [109] = 1015,
    [110] = 1016,
    [111] = 1017,
    [112] = 1018,
    [113] = 1019,
    [114] = 1020,
    [115] = 1021,
    [116] = 1022,
    [117] = 1023,
    [118] = 1024,
    [119] = 1025,
    [120] = 1026,
    [121] = 1027,
    [122] = 1028,
    [123] = 1029,
    [124] = 1030,
    [125] = 1316,
    [126] = 1317,
    [127] = 1318,
    [128] = 1327,
    [129] = 1328,
    [130] = 1329,
    [131] = 1331,
    [132] = 1332,
    [133] = 1336,
    [134] = 1337,
    [135] = 1338,
    [136] = 1339,
    [137] = 1340,
    [138] = 1341,
    [139] = 1342,
    [140] = 1343,
    [141] = 1344,
    [142] = 1353,
    [143] = 1357,
    [144] = 1358,
    [145] = 1359,
    [146] = 1360,
    [147] = 1361,
    [148] = 1362,
    [149] = 1363,
    [150] = 1367,
    [151] = 1368,
    [152] = 1369,
    [153] = 1370,
    [154] = 1371,
    [155] = 1372,
    [156] = 4354,
    [157] = 4354,
    [158] = 4355,
    [159] = 4356,
    [160] = 6001,
    [161] = 6002,
    [162] = 6003,
    [163] = 6004,
    [164] = 6005,
    [165] = 6006,
    [166] = 6007,
    [167] = 6008,
    [168] = 6009,
    [169] = 6010,
    [170] = 6011,
    [171] = 6012,
    [172] = 6013,
    [173] = 6014,
    [174] = 6015,
    [175] = 6016,
    [176] = 6017,
    [177] = 6018,
    [178] = 6019,
    [179] = 6020,
    [180] = 6021,
    [181] = 6022,
    [182] = 6023,
    [183] = 6024,
    [184] = 6025,
    [185] = 6026,
    [186] = 6027,
    [187] = 6028,
    [188] = 6029,
    [189] = 6030,
    [190] = 6031,
    [191] = 6032,
    [192] = 6033,
    [193] = 6101,
    [194] = 6102,
    [195] = 6103,
    [196] = 6104,
    [197] = 6105,
    [198] = 6106,
    [199] = 6107,
    [200] = 6108,
    [201] = 6109,
    [202] = 6110,
    [203] = 6111,
    [204] = 6112,
    [205] = 6113,
    [206] = 6114,
    [207] = 6115,
    [208] = 6116,
    [209] = 6117,
    [210] = 6118,
    [211] = 6119,
    [212] = 6120,
    [213] = 6121,
    [214] = 6122,
    [215] = 6123,
    [216] = 6124,
    [217] = 6125,
    [218] = 6126,
    [219] = 6127,
    [220] = 6128,
    [221] = 6129,
    [222] = 6130,
    [223] = 6131,
    [224] = 6132,
    [225] = 6133,
}

local music_kit_list = {
    [3] = "Crimsom Assault",
    [4] = "Sharpened",
    [5] = "Insurgency",
    [6] = "A*D*8",
    [7] = "High Noon",
    [8] = "Death's Head Demolition",
    [9] = "Desert Fire",
    [10] = "LNOE",
    [11] = "Metal",
    [12] = "All I Want for Christmas",
    [13] = "IsoRhythm",
    [14] = "For No Mankind",
    [15] = "Hotline Miami",
    [16] = "The 8-Bit Kit",
    [17] = "The Talos Principle",
    [18] = "Battlepack",
    [19] = "MOLOTOV",
    [20] = "Uber Blasto Phone",
    [21] = "Hazardous Environments",
    [22] = "Headshot",
    [23] = "Total Domination",
    [24] = "I Am",
    [25] = "Diamonds",
    [26] = "Invasion!",
    [27] = "Lion's Mouth",
    [28] = "Sponge Fingerz",
    [29] = "Aggressive",
    [30] = "Java Havana Funkaloo",
    [31] = "Moments CSGO",
    [32] = "Disgusting",
    [33] = "The Good Youth",
    [34] = "FREE",
    [35] = "Life's Not Out To Get You",
    [36] = "Backbone",
    [37] = "GLA",
    [38] = "Arena"
}

local ui = {
    enabled = NewCheckbox(misc, misc2, "Enable Medal/music/commend changer"),
    private_rank = NewSlider(misc, misc2, "Private rank", 0, 40, 0),
    commends_leader = NewSlider(misc, misc2, "Leader commends", 0, 9999, 0),
    commends_teacher = NewSlider(misc, misc2, "Teacher commends", 0, 9999, 0),
    commends_friendly = NewSlider(misc, misc2, "Friendly commends", 0, 9999, 0),
    ping = NewSlider(misc, misc2, "Ping", 0, 999, 0),
    coin = NewSlider(misc, misc2, "Medal", 0, 225, 0, true, "", 0, coin_list),
    music_kit = NewSlider(misc, misc2, "Music kit", 3, 38, 0, true, "", 0, music_kit_list),
}

local bv = {
    private_rank,
    commends_leader,
    commends_teacher,
    commends_friendly,
    ping,
    coin,
    music_kit,
}

local function GetProp(prop)
    local player_resource = GetAll("CCSPlayerResource")[1]
    return entity.get_prop(player_resource, prop, GetLocalPlayer())
end

local function SetProp(player_resource, prop, menu_item, value)
    if menu_item ~= nil then
        entity.set_prop(player_resource, prop, GetUi(menu_item), GetLocalPlayer())
    elseif value ~= nil then
        entity.set_prop(player_resource, prop, value, GetLocalPlayer())
    end
end

SetVisible(ui.private_rank, false)
SetVisible(ui.commends_leader, false)
SetVisible(ui.commends_teacher, false)
SetVisible(ui.commends_friendly, false)
SetVisible(ui.ping, false)
SetVisible(ui.coin, false)
SetVisible(ui.music_kit, false)

SetCallback(ui.enabled, function()
    SetVisible(ui.private_rank, GetUi(ui.enabled))
    SetVisible(ui.commends_leader, GetUi(ui.enabled))
    SetVisible(ui.commends_teacher, GetUi(ui.enabled))
    SetVisible(ui.commends_friendly, GetUi(ui.enabled))
    SetVisible(ui.ping, GetUi(ui.enabled))
    SetVisible(ui.coin, GetUi(ui.enabled))
    SetVisible(ui.music_kit, GetUi(ui.enabled))
end)

local backup_values = true

AddEvent("paint", function()
    
    local player_resource = GetAll("CCSPlayerResource")[1]
    
    if backup_values == true then
        bv.coin = GetProp("m_nActiveCoinRank", ui.coin)
        bv.music_kit = GetProp("m_nMusicID", ui.coin)
        bv.private_rank = GetProp("m_nPersonaDataPublicLevel", ui.coin)
        bv.commends_leader = GetProp("m_nPersonaDataPublicCommendsLeader", ui.coin)
        bv.commends_teacher = GetProp("m_nPersonaDataPublicCommendsTeacher", ui.coin)
        bv.commends_friendly = GetProp("m_nPersonaDataPublicCommendsFriendly", ui.coin)
        backup_values = false
    end

    if GetUi(ui.enabled) == true then
        SetProp(player_resource, "m_iPing", ui.ping, nil)
        entity.set_prop(player_resource, "m_nActiveCoinRank", coin_ids[GetUi(ui.coin)], GetLocalPlayer())
        entity.set_prop(player_resource, "m_nMusicID", GetUi(ui.music_kit), GetLocalPlayer())
        SetProp(player_resource, "m_nPersonaDataPublicLevel", ui.private_rank, nil)
        SetProp(player_resource, "m_nPersonaDataPublicCommendsLeader", ui.commends_leader, nil)
        SetProp(player_resource, "m_nPersonaDataPublicCommendsTeacher", ui.commends_teacher, nil)
        SetProp(player_resource, "m_nPersonaDataPublicCommendsFriendly", ui.commends_friendly, nil)
    else
        SetProp(player_resource, "m_iPing", nil, client.latency() * 1000)
        SetProp(player_resource, "m_nActiveCoinRank", nil, bv.coin)
        SetProp(player_resource, "m_nMusicID", nil, bv.music_kit)
        SetProp(player_resource, "m_nPersonaDataPublicLevel", nil, bv.private_rank)
        SetProp(player_resource, "m_nPersonaDataPublicCommendsLeader", nil, bv.commends_leader)
        SetProp(player_resource, "m_nPersonaDataPublicCommendsTeacher", nil, bv.commends_teacher)
        SetProp(player_resource, "m_nPersonaDataPublicCommendsFriendly", nil, bv.commends_friendly)
    end
end)
